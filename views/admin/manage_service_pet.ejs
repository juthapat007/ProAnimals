<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>จัดการ Service</title>
<%- include('../partials/link') %>
</head>
<body >
<div class="container ">
<%- include('../partials/header_admin') %><br>

<!-- Tabs -->
<div class="flex flex-wrap gap-4">
  <button class="tab-btn active" onclick="location.href='/admin/manage_service_pet'"><i class="fas fa-concierge-bell mr-2"></i>Service Type</button>
  <button class="tab-btn" onclick="location.href='/admin/manage_pet_type'"><i class="fas fa-paw mr-2"></i>Pet Type</button>
</div>

<!-- Header -->
<div class="text-center mb-8">
  <h1 class="header text-xl text-text mb-2"><i class="fas fa-concierge-bell text-primary2 mr-3"></i>จัดการ Service</h1>
  <div class="w-20 h-1 bg-gradient-to-r from-primary to-secondary mx-auto rounded-full"></div>
</div>

<!-- Form -->
<!-- Form -->
<div class="bg-white rounded-2xl shadow-xl p-4 mb-8 border-2 border-primary/20">
  <form id="serviceForm" action="/admin/manage_service_pet/add" method="POST" class="space-y-4">
    <input type="hidden" id="service_id" name="service_id">

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <!-- Input 1 -->
      <div>
        <label class="block text-lg font-medium text-text mb-2">ชื่อบริการ</label>
        <input type="text" id="service_type" name="service_type" placeholder="กรอกชื่อบริการ" required
          class="form-input w-full px-4 py-2 border-2 border-primary/30 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300">
      </div>

      <!-- Input 2 -->
      <div>
        <label class="block text-lg font-medium text-text mb-2">ราคา (บาท)</label>
        <input type="number" id="service_price" name="service_price" placeholder="0" min="0" required
          class="form-input w-full px-4 py-2 border-2 border-primary/30 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300">
      </div>

      <!-- Input 3 -->
      <div>
        <label class="block text-lg font-medium text-text mb-2">ระยะเวลา</label>
        <input type="text" id="service_time" name="service_time" placeholder="เช่น 30 นาที" required
          class="form-input w-full px-4 py-2 border-2 border-primary/30 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300">
      </div>
    </div>

    <!-- ปุ่ม -->
    <div class="flex justify-end gap-2 pt-2">
      <button type="submit" id="serviceSubmit"
        class="btn btn-add">
        <i class="fas fa-plus "></i> เพิ่ม
      </button>

      <button type="button" onclick="resetForm()"
        class="btn btn-cancel">
        <i class="fas fa-times "></i> ยกเลิก
      </button>

      <button type="submit"
        class="btn btn-delete"
        onclick="return confirm('คุณแน่ใจหรือไม่ว่าต้องการลบข้อมูลนี้?')">
        <i class="fas fa-trash "></i> ลบ
      </button>
    </div>
  </form>
</div>



<!-- Table -->
  <h3 class="text-lg font-semibold flex items-center text-text"><i class="fas fa-list text-primary2 mr-2"></i>รายการบริการ</h3>
 <br>
<div class="bg-white rounded-2xl shadow-xl overflow-hidden border-2 border-primary/20">
 
      <div class="overflow-x-auto shadow-lg rounded-lg">
    <table class="w-full min-w-[800px] border-collapse text-left bg-white rounded-lg">
      <thead>
        <tr>
          <th class="tb-p1">ID</th>
          <th class="tb-p2">ชื่อบริการ</th>
          <th class="tb-p3">ราคา</th>
          <th class="tb-p4">เวลา</th>
        </tr>
      </thead>
      <tbody>
        <% services.forEach((s,i)=>{ %>
          <tr class="clickable-row <%= i%2===0?'bg-gray-50':'bg-white' %>" onclick="editService('<%= s.service_id %>','<%= s.service_type %>','<%= s.service_price %>','<%= s.service_time %>')">
            <td class="px-4 py-4"><span class="bg-primary/10 text-text px-2 py-1 rounded-full text-lg"><%= s.service_id %></span></td>
            <td class="px-4 py-4 flex items-center "><span class="font-medium text-text"><%= s.service_type %></span></td>
            <td class="px-4 py-4"><span class="bg-success/10 text-success font-semibold px-3 py-1 rounded-full">฿<%= Number(s.service_price).toLocaleString() %></span></td>
            <td class="px-4 py-4"><span class="bg-info/10 text-info font-medium px-3 py-1 rounded-full"><i class="fas fa-clock mr-1"></i><%= s.service_time %></span></td>
            
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
  <% if(services.length===0){ %>
    <div class="text-center py-12 text-gray-500">
      <i class="fas fa-concierge-bell text-6xl mb-4"></i>
      <p>ยังไม่มีข้อมูลบริการ</p>
      <p class="text-gray-400">เริ่มต้นด้วยการเพิ่มบริการใหม่</p>
    </div>
  <% } %>
</div>
</div>
<script>
    function editService(id, type, price, time) {
      document.getElementById("service_id").value = id;
      document.getElementById("service_type").value = type;
      document.getElementById("service_price").value = price;
      document.getElementById("service_time").value = time;
      
      const btn = document.getElementById("serviceSubmit");
      btn.innerHTML = '<i class="fas fa-edit mr-2"></i>อัพเดต';
      btn.className = 'btn btn-edit';
      document.getElementById("serviceForm").action = "/admin/manage_service_pet/update";
      
      // Scroll to form and highlight
      document.getElementById("serviceForm").scrollIntoView({ behavior: 'smooth' });
      document.getElementById("service_type").focus();
      
      // Add a subtle animation to show it's in edit mode
      const inputs = document.querySelectorAll('#serviceForm input[type="text"], #serviceForm input[type="number"]');
      inputs.forEach(input => {
        input.classList.add('ring-2', 'ring-edit', 'ring-opacity-50');
        setTimeout(() => {
          input.classList.remove('ring-2', 'ring-edit', 'ring-opacity-50');
        }, 2000);
      });
    }

    // Reset form function
    function resetForm() {
      document.getElementById("serviceForm").reset();
      document.getElementById("service_id").value = '';
      const btn = document.getElementById("serviceSubmit");
      btn.innerHTML = '<i class="fas fa-plus mr-2"></i>เพิ่ม';
      btn.className = 'btn btn-add ';
      document.getElementById("serviceForm").action = "/admin/manage_service_pet/add";
    }

    // Add ESC key to reset form
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        resetForm();
      }
    });

    // Format price input
    document.getElementById('service_price').addEventListener('input', function(e) {
      let value = e.target.value.replace(/,/g, '');
      if (!isNaN(value) && value !== '') {
        e.target.value = Number(value).toLocaleString();
      }
    });

    // Add smooth animations
    document.addEventListener('DOMContentLoaded', function() {
      // Animate table rows
      const rows = document.querySelectorAll('tbody tr');
      rows.forEach((row, index) => {
        row.style.opacity = '0';
        row.style.transform = 'translateY(20px)';
        setTimeout(() => {
          row.style.transition = 'all 0.3s ease';
          row.style.opacity = '1';
          row.style.transform = 'translateY(0)';
        }, index * 50);
      });
    });
  </script>
</body>
</html>
